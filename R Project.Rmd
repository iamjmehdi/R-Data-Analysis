---
title: "R Project"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 




```{r}
library(shiny)
library(quantmod)
library(PerformanceAnalytics)
library(dygraphs)

monthly_returns <-function(ticker, base_year)
{
    #Obtain stock price data
    stock <-getSymbols(ticker, src = "yahoo", auto.assign = FALSE)
    #Remove missing values
    stock <- na.omit(stock)
    #Keep only adjusted closing prices
    stock <- stock[,6]
    
    #Begin at 2021 as base year and end at the last available trading day
    horizon <-paste0(as.character(base_year)), "/", as.character(Sys.Date())
    stock <- stock[horizon]
    
    #Calculate monthly arithmetic returns
    data <-periodReturn(stock, period ="monthly", type ="arithmetic")
    
    #Assign to the gloval environment to be accessible
    assign(ticker, data, envir = .GlobalEnv)
}

#Call our function for each stock
monthly_returns("FB", 2021)
monthly_returns("AMZN", 2021)
monthly_returns("NFLX", 2021)
monthly_returns("GOOG", 2021)
monthly_returns("AAPL", 2021)
monthly_returns("MSFT", 2021)

#Get S&P500 Data
monthly_returns("SPY", 2021)

#Merge All the Data and Rename Columns
returns <-merge.xts(FB, AMZN, NFLX, GOOG, AAPL, MSFT)
colnames(returns) <- c("FB", "AMZN", "NFLX", "GOOG", "AAPL", "MSFT", "SP500")

#Produce Interactive Chart
dygraph(returns, main = "FB vs AMZN vs NFLX vs GOOG vs AAPL vs MSFT vs SP500") %>%
    dyAxis("y", label = "Return", valueRange = c(-1, 0.5)) %>%
    dyRangeSelector(dateWindow = c("2021-01-04", "2021-06-11")) %>%
    dyOptions(colors = RColorBrewer::brewer.pal(4, "Set2"))

#Round
round(tail(returns, n = 5), 4)

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}

```

